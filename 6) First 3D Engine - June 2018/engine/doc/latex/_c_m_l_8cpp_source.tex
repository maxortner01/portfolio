\section{C\+M\+L.\+cpp}
\label{_c_m_l_8cpp_source}\index{src/engine/util/\+C\+M\+L.\+cpp@{src/engine/util/\+C\+M\+L.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "CML.h"}
00002 
00003 \textcolor{keyword}{using namespace }CML;
00004 
00005 \textcolor{keywordtype}{float} CML::radians(\textcolor{keywordtype}{float} degrees) \{
00006     \textcolor{comment}{//return degrees;}
00007     \textcolor{keywordflow}{return} degrees * (pi / 180.0f);
00008 \}
00009 
00010 \textcolor{comment}{/* ------- VERTEX */}
00011 vert3f::vert3f(\textcolor{keywordtype}{float} lx)                     \{ x = lx; y = 0;  z = 0;  \}
00012 vert3f::vert3f(\textcolor{keywordtype}{float} lx, \textcolor{keywordtype}{float} ly)           \{ x = lx; y = ly; z = 0;  \}
00013 vert3f::vert3f(\textcolor{keywordtype}{float} lx, \textcolor{keywordtype}{float} ly, \textcolor{keywordtype}{float} lz) \{ x = lx; y = ly; z = lz; \}
00014 
00015 vert2f::vert2f(\textcolor{keywordtype}{float} lx)                     \{ x = lx; y = 0;  \}
00016 vert2f::vert2f(\textcolor{keywordtype}{float} lx, \textcolor{keywordtype}{float} ly)           \{ x = lx; y = ly; \}
00017     
00018 \textcolor{comment}{/* ------- MATRIX */}
00019 Matrix4f::Matrix4f() \{
00020     init(MAT\_INDENTITY);
00021 \}
00022 
00023 Matrix4f::Matrix4f(MATenum initval) \{
00024     init(initval);
00025 \}
00026 
00027 \textcolor{keywordtype}{void} Matrix4f::init(MATenum val) \{
00028     \textcolor{comment}{//Set all values to 0}
00029     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < 4; y++) \{
00030         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < 4; x++) \{
00031             m[y][x] = 0;
00032         \}
00033     \}
00034 
00035     \textcolor{comment}{//If chosen preset is identity}
00036     \textcolor{keywordflow}{if} (val == MAT\_INDENTITY) \{
00037         m[0][0] = 1;
00038         m[1][1] = 1;
00039         m[2][2] = 1;
00040         m[3][3] = 1;
00041     \}
00042 \}
00043 
00044 \textcolor{keywordtype}{void} Matrix4f::mult(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{float} val) \{
00045     m[y][x] = m[y][x] * val;
00046 \}
00047 
00048 \textcolor{keywordtype}{void} Matrix4f::add(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{float} val) \{
00049     m[y][x] = m[y][x] + val;
00050 \}
00051 
00052 \textcolor{keywordtype}{void} Matrix4f::set(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{float} val) \{
00053     m[y][x] = val;
00054 \}
00055 
00056 \textcolor{keywordtype}{float} Matrix4f::get(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y) \{
00057     \textcolor{keywordflow}{return} m[y][x];
00058 \}
00059 
00060 Matrix4f* Matrix4f::mul(Matrix4f* matrix) \{
00061     Matrix4f* target = \textcolor{keyword}{new} Matrix4f(MAT\_INDENTITY);
00062 
00063     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < 4; y++) \{
00064         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < 4; x++) \{
00065             \textcolor{keywordtype}{float} val = 0.0f;
00066 
00067             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < 4; s++) \{
00068                 val += (m[s][x] * matrix->get(y, s));
00069             \}
00070 
00071             target->set(x, y, val);
00072         \}
00073     \}
00074 
00075     \textcolor{keywordflow}{return} target;
00076 \}
00077 
00078 Matrix4f* Matrix4f::mul(vert3f* point) \{
00079     Matrix4f* target = \textcolor{keyword}{new} Matrix4f(MAT\_INDENTITY);
00080 
00081     \textcolor{keywordtype}{float} positions[4] \{point->x, point->y, point->z, 1\};
00082     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < 4; y++) \{
00083         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < 4; x++) \{
00084             target->set(x, y, m[y][x] * positions[x]);
00085         \}
00086     \}
00087 
00088     \textcolor{keywordflow}{return} target;
00089 \}
00090         
00091 \textcolor{comment}{//Translate matrix by translation}
00092 \textcolor{keywordtype}{void} Matrix4f::translate(vert3f* translation) \{
00093     add(3, 0, translation->x);
00094     add(3, 1, translation->y);
00095     add(3, 2, translation->z);
00096 \}
00097 
00098 \textcolor{keywordtype}{void} Matrix4f::setTranslation(vert3f* translation) \{
00099     \textcolor{keyword}{set}(3, 0, translation->x);
00100     \textcolor{keyword}{set}(3, 1, translation->y);
00101     \textcolor{keyword}{set}(3, 2, translation->z);
00102 \}
00103 
00104 \textcolor{comment}{//Scale matrix by factor}
00105 \textcolor{keywordtype}{void} Matrix4f::scale(vert3f* factor) \{
00106     add(0, 0, factor->x);
00107     add(1, 1, factor->y);
00108     add(2, 2, factor->z);
00109 \}
00110 
00111 \textcolor{comment}{//Set scale}
00112 \textcolor{keywordtype}{void} Matrix4f::setScale(vert3f* factor) \{
00113     \textcolor{keyword}{set}(0, 0, factor->x);
00114     \textcolor{keyword}{set}(1, 1, factor->y);
00115     \textcolor{keyword}{set}(2, 2, factor->z);
00116 \}
00117 
00118 \textcolor{comment}{//Rotate matrix by degrees}
00119 \textcolor{keywordtype}{void} Matrix4f::rotate(vert3f* rotation) \{
00120     vert3f* rr = \textcolor{keyword}{new} vert3f( 
00121         radians(rotation->x),
00122         radians(rotation->y),
00123         radians(rotation->z)
00124     );
00125 
00126     \textcolor{keywordtype}{float} m00 =   std::cos( rr->y )  * std::cos( rr->z );
00127     \textcolor{keywordtype}{float} m10 = -(std::cos( rr->y )) * std::sin( rr->z );
00128     \textcolor{keywordtype}{float} m20 =   std::sin( rr->y );
00129     
00130     \textcolor{keywordtype}{float} m01 =  ( std::sin( rr->x ) * std::sin( rr->y ) * std::cos( rr->z ) );
00131     \textcolor{comment}{/*-*/} m01 = m01 + ( std::cos( rr->x ) * std::sin( rr->z ) );
00132     \textcolor{keywordtype}{float} m11 = -( std::sin( rr->x ) ) * std::sin( rr->y ) * std::sin( rr->z );
00133     \textcolor{comment}{/*-*/} m11 = m11 + ( std::cos( rr->x ) * std::cos( rr->z ) );
00134     \textcolor{keywordtype}{float} m21 = -( std::sin( rr->x ) ) * std::cos( rr->y );
00135 
00136     \textcolor{keywordtype}{float} m02 = -( std::cos( rr->x ) ) * std::sin( rr->y ) * std::cos( rr->z );
00137     \textcolor{comment}{/*-*/} m02 = m02 + ( std::sin( rr->x ) * std::sin( rr->z ) );
00138     \textcolor{keywordtype}{float} m12 =  ( std::cos( rr->x ) * std::sin( rr->y ) * std::sin( rr->z ) );
00139     \textcolor{comment}{/*-*/} m12 = m12 + ( std::sin( rr->x ) * std::cos( rr->z ) );
00140     \textcolor{keywordtype}{float} m22 =  ( std::cos( rr->x ) * std::cos( rr->y ) );
00141 
00142     add( 0, 0, m00 );
00143     add( 1, 0, m10 );
00144     add( 2, 0, m20 );
00145    
00146     add( 0, 1, m01 );
00147     add( 1, 1, m11 );
00148     add( 2, 1, m21 );
00149 
00150     add( 0, 2, m02 );
00151     add( 1, 2, m12 );
00152     add( 2, 2, m22 );
00153 
00154     \textcolor{comment}{/*}
00155 \textcolor{comment}{    //rotate by x}
00156 \textcolor{comment}{    add(1, 1,      std::cos( rr->x ));}
00157 \textcolor{comment}{    add(2, 1, -1 * std::sin( rr->x ));}
00158 \textcolor{comment}{    add(1, 2,      std::sin( rr->x ));}
00159 \textcolor{comment}{    add(2, 2,      std::cos( rr->x ));}
00160 \textcolor{comment}{}
00161 \textcolor{comment}{    //rotate by y}
00162 \textcolor{comment}{    add(0, 0,      std::cos( rr->y ));}
00163 \textcolor{comment}{    add(0, 2, -1 * std::sin( rr->y ));}
00164 \textcolor{comment}{    add(2, 0,      std::sin( rr->y ));}
00165 \textcolor{comment}{    add(2, 2,      std::cos( rr->y ));}
00166 \textcolor{comment}{}
00167 \textcolor{comment}{    //rotate by z}
00168 \textcolor{comment}{    add(0, 0,      std::cos( rr->z ));}
00169 \textcolor{comment}{    add(1, 0, -1 * std::sin( rr->z ));}
00170 \textcolor{comment}{    add(0, 1,      std::sin( rr->z ));}
00171 \textcolor{comment}{    add(1, 1,      std::cos( rr->z ));}
00172 \textcolor{comment}{    */}
00173     \textcolor{keyword}{delete} rr;
00174 \}
00175 
00176 \textcolor{comment}{/*Return float matrix}
00177 \textcolor{comment}{float** Matrix4f::getValues() \{}
00178 \textcolor{comment}{    return m;}
00179 \textcolor{comment}{\} */}
\end{DoxyCode}
