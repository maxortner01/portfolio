\section{model.\+cpp}
\label{model_8cpp_source}\index{src/engine/components/model.\+cpp@{src/engine/components/model.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "model.h"}
00002 
00003 \textcolor{keywordtype}{void} Model::update() \{ \textcolor{comment}{/*...*/} \}
00004 
00005 Model::Model(std::vector<float> vertices, std::vector<float> colors) \{
00006     outlines = \textcolor{keyword}{false};
00007     
00008     std::cout << \textcolor{stringliteral}{"\(\backslash\)nCreating Model..."} << std::endl;
00009 
00010     glCreateBuffers(2, buffers);
00011     std::cout << \textcolor{stringliteral}{"  Vertex Buffer: "} << buffers[VERTICES] << std::endl;
00012 
00013     newVertices(vertices, colors);
00014 \}
00015 
00016 \textcolor{keywordtype}{void} Model::newVertices(std::vector<float> vertices, std::vector<float> colors) \{
00017     vertexData = vertices;
00018 
00019     std::cout << \textcolor{stringliteral}{"  Binding buffer..."} << std::endl;
00020     glBindBuffer(GL\_ARRAY\_BUFFER, buffers[VERTICES]);
00021 
00022     std::cout << \textcolor{stringliteral}{"  Uploading data to buffer..."} << std::endl;
00023     std::cout << \textcolor{stringliteral}{"  "} << vertices.size() << \textcolor{stringliteral}{" vertices..."} << std::endl; 
00024     glBufferData(GL\_ARRAY\_BUFFER, vertices.size() * \textcolor{keyword}{sizeof}(float), &vertices[0], GL\_STATIC\_DRAW);
00025     
00026     glEnableVertexAttribArray(0);
00027     glVertexAttribPointer(0, 3, GL\_FLOAT, GL\_FALSE, 0, 0);
00028     glDisableVertexAttribArray(0);
00029     
00030     std::cout << \textcolor{stringliteral}{"  Done!"} << std::endl;
00031 \}
00032 
00033 \textcolor{keywordtype}{void} Model::render(Shader* shader, glm::mat4 model, Camera* camera) \{
00034 
00035     glEnable(GL\_DEPTH\_TEST);
00036     glDepthFunc(GL\_LEQUAL);
00037 
00038     \textcolor{comment}{//get perspective}
00039     mat4 pers = camera->getProjection();
00040     \textcolor{comment}{//get view}
00041     mat4 view = camera->getViewMatrix();
00042     \textcolor{comment}{//view * model}
00043     mat4 modelview = view * model;
00044     \textcolor{comment}{//model * modelview}
00045     mat4 target = pers * modelview;
00046 
00047 
00048     shader->bind();
00049 
00050     shader->setMatrix(target);
00051     shader->setUniform(\textcolor{stringliteral}{"fog\_start"}, camera->getFogStart());
00052     shader->setUniform(\textcolor{stringliteral}{"fog\_distance"}, camera->getFogDistance());
00053 
00054     glBindBuffer(GL\_ARRAY\_BUFFER, buffers[VERTICES]);
00055 
00056     glEnableVertexAttribArray(0);
00057     glVertexAttribPointer(0, 3, GL\_FLOAT, GL\_FALSE, 0, 0);
00058 
00059     glDrawArrays(GL\_TRIANGLES, 0, vertexData.size());
00060 
00061     \textcolor{keywordflow}{if} (outlines) \{
00062         glDrawArrays(GL\_LINES, 0, vertexData.size());
00063     \}
00064 
00065     shader->unbind();
00066     glDisableVertexAttribArray(0);
00067 \}
00068 
00069 \textcolor{keywordtype}{void} Model::toggleOutlines() \{
00070     \textcolor{keywordflow}{if} (outlines) 
00071         outlines = \textcolor{keyword}{false};
00072     \textcolor{keywordflow}{else}
00073         outlines = \textcolor{keyword}{true};
00074 \}
\end{DoxyCode}
